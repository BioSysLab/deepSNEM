moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
id <- which(labels$moa == "FGFR inhibitor|PDGFR tyrosine kinase receptor inhibitor|VEGFR inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi,multi)
multi$moa_v1 <- c(pdgfr,vegfr,fgfr)
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
#labels$moa_v1[which(labels$moa == "FLT3 inhibitor")] <- flt
#labels$moa_v1[which(labels$moa == "RAF inhibitor")] <- "raf_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
id <- which(labels$moa == "KIT inhibitor|PDGFR tyrosine kinase receptor inhibitor|VEGFR inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi,multi)
multi$moa_v1 <- c(pdgfr,vegfr,kit)
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
#labels$moa_v1[which(labels$moa == "FLT3 inhibitor")] <- flt
#labels$moa_v1[which(labels$moa == "RAF inhibitor")] <- "raf_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
id <- which(labels$moa == "Bcr-Abl kinase inhibitor|ephrin inhibitor|KIT inhibitor|PDGFR tyrosine kinase receptor inhibitor|SRC inhibitor|tyrosine kinase inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi,multi,multi,multi)
multi$moa_v1 <- c(pdgfr,bcr,kit,src,trk)
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
#labels$moa_v1[which(labels$moa == "FLT3 inhibitor")] <- flt
#labels$moa_v1[which(labels$moa == "RAF inhibitor")] <- "raf_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
# pdgfr bcr kit trk
id <- which(labels$moa == "Bcr-Abl kinase inhibitor|KIT inhibitor|PDGFR tyrosine kinase receptor inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi,multi,multi)
multi$moa_v1 <- c(pdgfr,bcr,kit,trk)
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
#labels$moa_v1[which(labels$moa == "FLT3 inhibitor")] <- flt
#labels$moa_v1[which(labels$moa == "RAF inhibitor")] <- "raf_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
labels$moa_v1[which(labels$moa == "PDGFR tyrosine kinase receptor inhibitor")] <- pdgfr
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
raf <- "raf_inhibitor"
flt <- "flt_inhibitor"
pdgfr <- "pdgfr_inhibitor"
vegfr <- "vegfr_inhibitor"
kit <- "kit_inhibitor"
fgfr <- "fgfr_inhibitor"
src <- "src_inhibitor"
bcr <- "bcr_abl_inhibitor"
jak <- "jak_inhibitor"
egfr <- "egfr_inhibitor"
gfr <- "gfr_inhibitor"
trk <- "tyrosine_kinase_inhibitor"
cmet <- "cmet_inhibitor"
pkc <- "pkc_inhibitor"
id <- which(labels$moa == "Abl kinase inhibitor|SRC inhibitor|VEGFR inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi,multi)
multi$moa_v1 <- c(vegfr,bcr,src)
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
#labels$moa_v1[which(labels$moa == "FLT3 inhibitor")] <- flt
#labels$moa_v1[which(labels$moa == "RAF inhibitor")] <- "raf_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
id <- which(labels$moa == "FGFR inhibitor|VEGFR inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi)
multi$moa_v1 <- c(vegfr,fgfr)
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
#labels$moa_v1[which(labels$moa == "FLT3 inhibitor")] <- flt
#labels$moa_v1[which(labels$moa == "RAF inhibitor")] <- "raf_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
id <- which(labels$moa == "KIT inhibitor|VEGFR inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi)
multi$moa_v1 <- c(vegfr,kit)
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
labels$moa_v1[which(labels$moa == "VEGFR inhibitor")] <- vegfr
#labels$moa_v1[which(labels$moa == "RAF inhibitor")] <- "raf_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
id <- which(labels$moa == "Abl kinase inhibitor|Bcr-Abl kinase inhibitor|SRC inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi)
multi$moa_v1 <- c(src,bcr)
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
labels$moa_v1[which(labels$moa == "SRC inhibitor")] <- src
#labels$moa_v1[which(labels$moa == "RAF inhibitor")] <- "raf_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
id <- which(labels$moa == "EGFR inhibitor|SRC inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi)
multi$moa_v1 <- c(src,egfr)
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
#labels$moa_v1[which(labels$moa == "SRC inhibitor")] <- src
#labels$moa_v1[which(labels$moa == "RAF inhibitor")] <- "raf_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
labels$moa_v1[which(labels$moa == "Abl kinase inhibitor|Bcr-Abl kinase inhibitor")] <- bcr
labels$moa_v1[which(labels$moa == "Bcr-Abl kinase inhibitor")] <- bcr
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
id <- which(labels$moa == "EGFR inhibitor|JAK inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi)
multi$moa_v1 <- c(egfr,jak)
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
labels$moa_v1[which(labels$moa == "JAK inhibitor")] <- jak
#labels$moa_v1[which(labels$moa == "RAF inhibitor")] <- "raf_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
id <- which(labels$moa == "EGFR inhibitor|PKC inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi)
multi$moa_v1 <- c(egfr,pkc)
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
labels$moa_v1[which(labels$moa == "EGFR_inhibitor")] <- egfr
#labels$moa_v1[which(labels$moa == "RAF inhibitor")] <- "raf_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
View(moa_v1)
labels$moa_v1[which(labels$moa == "EGFR_inhibitor")] <- egfr
#labels$moa_v1[which(labels$moa == "RAF inhibitor")] <- "raf_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
labels$moa_v1[which(labels$moa == "growth factor receptor inhibitor")] <- gfr
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
trk_in <- c("tyrosine kinase inhibitor","protein tyrosine kinase inhibitor","protein tyrosine kinase inhibitor|tyrosine kinase inhibitor")
labels$moa_v1[which(labels$moa_v1 %in% trk_in)] <- trk
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
View(multiples)
labels$moa_v1[which(labels$moa == "c-Met inhibitor")] <- cmet
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
labels$moa_v1[which(labels$moa == "PKC inhibitor")] <- pkc
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
estro_antagonist <- c("estrogen receptor antagonist","estrogen receptor antagonist|selective estrogen receptor modulator (SERM)")
labels$moa_v1[which(labels$moa_v1 %in% estro_antagonist)] <- "estrogen_antagonist"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
id <- which(labels$moa == "estrogen receptor antagonist|progesterone receptor agonist")
multi <- labels[id,]
multi <- bind_rows(multi,multi)
multi$moa_v1 <- c("estrogen_antagonist","progesterone_agonist")
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
#labels$moa_v1[which(labels$moa == "EGFR_inhibitor")] <- egfr
#labels$moa_v1[which(labels$moa == "RAF inhibitor")] <- "raf_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
labels$moa_v1[which(labels$moa == "estrogen receptor agonist")] <- "estrogen_agonist"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
ribo_nuc <- c("ribonucleotide reductase inhibitor","adenosine deaminase inhibitor|ribonucleotide reductase inhibitor")
labels$moa_v1[which(labels$moa_v1 %in% ribo_nuc)] <- "ribonucleotide_reductase_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(multiples)
p450 <- c("cytochrome P450 inhibitor","cytochrome P450 inhibitor|imidazoline receptor ligand")
labels$moa_v1[which(labels$moa_v1 %in% p450)] <- "p450_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
pota_activ <- c("potassium channel activator","nitric oxide donor|potassium channel activator")
labels$moa_v1[which(labels$moa_v1 %in% pota_activ)] <- "potassium_activator"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
labels$moa_v1[which(labels$moa == "progesterone receptor agonist")] <- "progesterone_agonist"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
bact_ribo <- c("bacterial 50S ribosomal subunit inhibitor","bacterial 30S ribosomal subunit inhibitor")
labels$moa_v1[which(labels$moa_v1 %in% bact_ribo] <- "bacterial_ribosomal_inhibitor"
labels$moa_v1[which(labels$moa_v1 %in% bact_ribo]]<- "bacterial_ribosomal_inhibitor"
labels$moa_v1[which(labels$moa_v1 %in% bact_ribo)]<- "bacterial_ribosomal_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
antibacterial <- c("bacterial_ribosomal_inhibitor","antibacterial agent","bacterial antifolate")
labels$moa_v1[which(labels$moa_v1 %in% antibacterial)]<- "antibacterial"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(multiples)
id <- which(labels$moa == "aldehyde dehydrogenase inhibitor|DNA methyltransferase inhibitor|TRPV agonist")
multi <- labels[id,]
multi <- bind_rows(multi,multi)
multi$moa_v1 <- c("dna_methyltransferase_inhibitor","trpv_agonist")
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
labels$moa_v1[which(labels$moa == "DNA methyltransferase inhibitor")] <- "dna_methyltransferase_inhibitor"
labels$moa_v1[which(labels$moa == "TRPV agonist")] <- "trpv_agonist"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
ppar <- c("PPAR receptor agonist","insulin sensitizer|PPAR receptor agonist")
labels$moa_v1[which(labels$moa_v1 %in% ppar)]<- "ppar_agonist"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
prosta_agonist <- c("prostanoid receptor agonist","platelet aggregation inhibitor|prostanoid receptor agonist")
labels$moa_v1[which(labels$moa_v1 %in% prosta_agonist)]<- "prostanoid_agonist"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
syk <- c("SYK inhibitor","mediator release inhibitor|SYK inhibitor")
labels$moa_v1[which(labels$moa_v1 %in% syk)]<- "syk_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
bcl <- c("BCL inhibitor","BCL inhibitor|MCL1 inhibitor")
labels$moa_v1[which(labels$moa_v1 %in% bcl)]<- "bcl_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
chk <- c("CHK inhibitor","CHK inhibitor|cytochrome P450 activator|indoleamine 2,3-dioxygenase inhibitor")
labels$moa_v1[which(labels$moa_v1 %in% chk)]<- "chk_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
id <- which(labels$moa == "dehydrogenase inhibitor|inositol monophosphatase inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi)
multi$moa_v1 <- c("dehydrogenase_inhibitor","dehydrogenase_inhibitor","dehydrogenase_inhibitor","inositol_inhibitor","inositol_inhibitor","inositol_inhibitor")
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
labels$moa_v1[which(labels$moa == "inositol monophosphatase inhibitor")] <- "inositol_inhibitor"
labels$moa_v1[which(labels$moa == "11-beta hydroxysteroid dehydrogenase inhibitor|FXR agonist")] <- "dehydrogenase_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
vitamin_d <- c("vitamin D receptor agonist","FXR antagonist|vitamin D receptor agonist")
labels$moa_v1[which(labels$moa_v1 %in% vitamin_d)]<- "vitamin_d_agonist"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
adenosine <- c("adenosine receptor agonist|cAMP stimulant","adenosine receptor agonist")
labels$moa_v1[which(labels$moa_v1 %in% adenosine)]<- "adenosine_agonist"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
anticancer <- c("anticancer agent","anticancer agent|aryl hydrocarbon receptor antagonist")
labels$moa_v1[which(labels$moa_v1 %in% anticancer)]<- "anticancer"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
faah <- c("FAAH inhibitor","FAAH inhibitor|FAAH reuptake inhibitor")
labels$moa_v1[which(labels$moa_v1 %in% faah)]<- "faah_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
antifungal <- c("fungal squalene epoxidase inhibitor","other antifungal")
labels$moa_v1[which(labels$moa_v1 %in% antifungal)]<- "antifungal"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
View(multiples)
snri <- c("norepinephrine reputake inhibitor","adrenergic inhibitor|norepinephrine reuptake inhibitor|serotoninâ€“norepinephrine reuptake inhibitor (SNRI)",
"norepinephrine inhibitor|norepinephrine reuptake inhibitor|serotonin receptor antagonist|serotoninâ€“norepinephrine reuptake inhibitor (SNRI)",
"norepinephrine reuptake inhibitor","serotoninâ€“norepinephrine reuptake inhibitor (SNRI)")
labels$moa_v1[which(labels$moa_v1 %in% snri)]<- "snri"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
transported <- c("sodium/potassium/chloride transporter inhibitor","sodium/glucose cotransporter inhibitor")
labels$moa_v1[which(labels$moa_v1 %in% transported)]<- "sodium_potassium_chloride_transporter_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
View(moa_v1)
acetyl <- c("acetylcholine release enhancer","acetylcholine receptor agonist")
labels$moa_v1[which(labels$moa_v1 %in% acetyl)]<- "acetylcholine_agonist"
View(moa_v1)
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
androgen <- c("androgen receptor antagonist","androgen receptor modulator")
labels$moa_v1[which(labels$moa_v1 %in% androgen)]<- "androgen_antagonist"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
arrhy <- c("antiarrhythmic","antiarrhythmic medication")
labels$moa_v1[which(labels$moa_v1 %in% arrhy)]<- "anti_arrhythmic"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
saveRDS(multiples,"data/cmap/labels_multiples_10_5.rds")
saveRDS(labels,"data/cmap/labels_10_5.rds")
library(tidyverse)
multiples <- readRDS("data/cmap/labels_multiples_10_5.rds")
labels <- readRDS("data/cmap/labels_10_5.rds")
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
anticancer <- c("antineoplastic agent","anticancer")
labels$moa_v1[which(labels$moa_v1 %in% anticancer)]<- "anticancer"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(moa_v1)
trpv_ant <- c("aromatase inhibitor|TRPV antagonist","TRPV antagonist")
View(multiples)
trpv_ant <- c("aromatase inhibitor|TRPV antagonist","TRPV antagonist")
labels$moa_v1[which(labels$moa_v1 %in% trpv_ant)]<- "trpv_antagonist"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
moa_copy <- moa_v1
View(moa_copy)
id <- which(labels$moa == "benzodiazepine receptor agonist|HDAC inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi)
multi$moa_v1 <- c("hdac_inhibitor","benzo_agonist")
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
labels$moa_v1[which(labels$moa == "benzodiazepine receptor agonist")] <- "benzo_agonist"
labels$moa_v1[which(labels$moa == "HDAC inhibitor")] <- "hdac_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
moa_copy <- moa_v1
choli <- c("acetylcholinesterase inhibitor","cholinesterase inhibitor")
labels$moa_v1[which(labels$moa_v1 %in% choli)]<- "acetylcholinesterase_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
moa_copy <- moa_v1
View(moa_v1)
View(moa_copy)
id <- which(labels$moa == "diacylglycerol kinase inhibitor|protein kinase inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi)
kin_inh <- c("protein kinase inhibitor","diacylglycerol kinase inhibitor|protein kinase inhibitor")
labels$moa_v1[which(labels$moa_v1 %in% kin_inh)]<- "kinase_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
moa_copy <- moa_v1
View(moa_v1)
View(moa_copy)
peptidase <- c("dehydropeptidase inhibitor","dipeptidyl peptidase inhibitor","peptidase inhibitor")
labels$moa_v1[which(labels$moa_v1 %in% peptidase)]<- "peptidase_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
moa_copy <- moa_v1
View(moa_copy)
View(moa_v1)
dnapol <- c("DNA directed DNA polymerase inhibitor|thymidylate synthase inhibitor","DNA polymerase inhibitor")
id <- which(labels$moa == "DNA directed DNA polymerase inhibitor|thymidylate synthase inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi)
multi$moa_v1 <- c("dna_pol_inhibitor","thymidylate_synthase_inhibitor")
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
labels$moa_v1[which(labels$moa == "thymidylate synthase inhibitor")] <- "thymidylate_synthase_inhibitor"
labels$moa_v1[which(labels$moa == "DNA polymerase inhibitor")] <- "dna_pol_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
moa_copy <- moa_v1
View(moa_v1)
View(moa_copy)
gaba <- c("GABA receptor antagonist","GABA receptor antagonist|GABA receptor modulator",
"GABA receptor antagonist|TP53 activator","GABA receptor modulator","GABA receptor negative allosteric modulator")
labels$moa_v1[which(labels$moa_v1 %in% gaba)]<- "gaba_antagonist"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
moa_copy <- moa_v1
View(multiples)
id <- which(labels$moa == "HIV integrase inhibitor|nucleoside reverse transcriptase inhibitor")
multi <- labels[id,]
multi <- bind_rows(multi,multi)
multi$moa_v1 <- c("hiv_integrase","nucleoside_reverse_transcriptase_inhibitor")
multiples <- bind_rows(multiples,multi)
labels <- labels[-id,]
labels$moa_v1[which(labels$moa == "nucleoside reverse transcriptase inhibitor")] <- "nucleoside_reverse_transcriptase_inhibitor"
labels$moa_v1[which(labels$moa == "HIV integrase inhibitor")] <- "hiv_integrase"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
moa_copy <- moa_v1
View(moa_v1)
View(moa_copy)
View(multiples)
labels$moa_v1[which(labels$moa == "leucine rich repeat kinase inhibitor")] <- "leucine_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
moa_copy <- moa_v1
muscle <- c("muscle relaxant","myorelaxant")
labels$moa_v1[which(labels$moa_v1 %in% muscle)]<- "muscle_relaxant"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
moa_copy <- moa_v1
View(moa_v1)
View(moa_copy)
View(moa_v1)
phosphatase <- c("mitochondrial DNA polymerase inhibitor|phosphatase inhibitor","protein phosphatase inhibitor")
labels$moa_v1[which(labels$moa_v1 %in% phosphatase)]<- "phosphatase_inhibitor"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
moa_copy <- moa_v1
View(moa_v1)
View(moa_copy)
rna_dna <- c("dna_rna_damage","RNA polymerase inhibitor")
labels$moa_v1[which(labels$moa_v1 %in% rna_dna)]<- "dna_rna_damage"
moa_v1 <- labels %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
moa_copy <- moa_v1
View(moa_v1)
View(moa_copy)
saveRDS(multiples,"data/cmap/labels_multiples_10_5.rds")
saveRDS(labels,"data/cmap/labels_10_5.rds")
length(unique(labels$rdkit_graph))
length(unique(labels$rdkit_broad))
all <- bind_rows(labels,multiples)
all_moa_v1 <- all %>% group_by(moa_v1) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(all_moa_v1)
View(all)
all_orig <- readRDS("data/cmap/labels.rds")
all_orig <- all_orig %>% mutate(target = str_split(string = target,pattern = "|"))
View(all_orig)
all_orig <- readRDS("data/cmap/labels.rds")
all_orig <- all_orig %>% mutate(target = str_split(string = target,pattern = "|")) %>% unnest()
View(all_orig)
all_orig <- readRDS("data/cmap/labels.rds")
all_orig <- all_orig %>% mutate(target = str_split(string = target,pattern = "\\|")) %>% unnest()
View(all_orig)
targets <- all_orig %>% group_by(target) %>% summarise(count = n()) %>% arrange(desc(count)) %>% mutate(cs = cumsum(count))
View(targets)
View(targets)
View(labels)
group_check <- function(group,group_name,original_big_group,
labels,emb_test,file_info,emb_size,output_dir,
label_space_only, tsne_perpl, umap_n,
cell_specific,cell_line,genes, ds_path,
landmark,sig_map,tsne_perpl_genes, init_dim, init_dim_genes){
library(tidyverse)
library(clustree)
library(Rtsne)
library(ggplot2)
library(umap)
get_cmap_signatures <- function(cmap_path_to_gctx, sig_ids, landmark = TRUE, landmark_df = NULL) {
library(tidyverse)
library(cmapR)
library(rhdf5)
library(AnnotationDbi)
library(org.Hs.eg.db)
ds_path <- cmap_path_to_gctx
if (landmark == TRUE) {
cmap_gctx <- parse.gctx(ds_path,rid = as.character(landmark_df$`Entrez ID`), cid = sig_ids)
cmap <- cmap_gctx@mat
cmap <- cmap[as.character(landmark_df$`Entrez ID`),]
rownames(cmap) <- landmark_df$Symbol
}
if (landmark == FALSE) {
cmap_gctx <- parse.gctx(ds_path, cid = sig_ids)
cmap <- cmap_gctx@mat
entrez <- rownames(cmap)
anno <- AnnotationDbi::select(org.Hs.eg.db,
keys = entrez,
columns = c("SYMBOL", "GENENAME","ENTREZID"),
keytype = "ENTREZID")
anno <- anno %>%
filter(!is.na(SYMBOL))
cmap <- cmap[anno$ENTREZID,]
rownames(cmap) <- anno$SYMBOL
}
return(cmap)
}
dir.create(output_dir,recursive = T)
labels$moa_v1 <- labels$moa
labels$moa_v1[which(labels$moa %in% group)] <- group_name
labels_v1 <- left_join(labels,file_info, by = c("rdkit_graph"="rdkit"))
labels_v1 <- labels_v1 %>% mutate(test_labels = if_else(condition = (moa_v1 == group_name),true = group_name,false = "nada"))
if (original_big_group != "") {
labels_v1 <- labels_v1 %>%
mutate(test_labels = if_else(condition = (moa == original_big_group),true = original_big_group,false = test_labels))
}
if (label_space_only) {
emb_test <- emb[which(emb$emb %in% labels_v1$emb),]
}
emb_test <- left_join(emb_test,labels_v1,by="emb")
if (cell_specific) {
emb_test <- emb_test[which(as.character(emb_test$cell_id) %in% cell_line),]
}
print(nrow(emb_test))
tsne_test <- Rtsne(scale(emb_test[,2:(emb_size+1)]), dims = 2, perplexity=tsne_perpl, verbose=TRUE, max_iter = 1000,initial_dims = init_dim)
df_test <- data.frame(V1 = tsne_test$Y[,1], V2 =tsne_test$Y[,2], label = as.factor(emb_test$test_labels))
colors <- c( "#E69F00","#999999", "#56B4E9")
names(colors) <- c(as.character(original_big_group),"nada",as.character(group_name))
gtsne <- ggplot(df_test, aes(V1, V2))+
geom_point(aes(color = label),show.legend = T) + scale_color_manual(values=colors)
png(file=paste0(output_dir,"/",as.character(group_name),"tsne.png"),width=9,height=9,units = "in",res=300)
print(gtsne)
dev.off()
umap.defaults$n_neighbors <- umap_n
map_test <- umap(scale(emb_test[,2:(emb_size+1)]))
df_map <- data.frame(V1 = map_test$layout[,1], V2 = map_test$layout[,2], label = as.factor(emb_test$test_labels))
gmap <- ggplot(df_map, aes(V1, V2))+
geom_point(aes(color = label),show.legend = T) + scale_color_manual(values=colors)
png(file=paste0(output_dir,"/",as.character(group_name),"umap.png"),width=9,height=9,units = "in",res=300)
print(gmap)
dev.off()
emb_test <- left_join(emb_test,file_info,by = "emb")
emb_test <- left_join(emb_test,sig_map,by=c("sig_id.y"="sig_id2"))
if (genes) {
emb_genes <- get_cmap_signatures(as.character(emb_test$sig_id),cmap_path_to_gctx = ds_path,landmark = T, landmark_df = landmark)
emb_genes <- t(emb_genes)
emb_genes <- as.data.frame(emb_genes) %>% rownames_to_column("sig_id")
tsne_genes <- Rtsne(scale(emb_genes[,2:ncol(emb_genes)]), dims = 2, perplexity=tsne_perpl_genes, verbose=TRUE, max_iter = 1000,initial_dims = init_dim_genes)
df_tsne_genes <- data.frame(V1 = tsne_genes$Y[,1], V2 =tsne_genes$Y[,2], label = as.factor(emb_test$test_labels))
gtsne_genes <- ggplot(df_tsne_genes, aes(V1, V2))+
geom_point(aes(color = label),show.legend = T) + scale_color_manual(values=colors)
#map_genes <- umap(scale(emb_genes[,2:ncol(emb_genes)]))
#df_map_genes <- data.frame(V1 = map_genes$layout[,1], V2 = map_genes$layout[,2], label = as.factor(emb_test$test_labels))
#gmap_genes <- ggplot(df_map_genes, aes(V1, V2))+
#geom_point(aes(color = label),show.legend = T) + scale_color_manual(values=colors)
png(file=paste0(output_dir,"/",as.character(group_name),"tsne_genes.png"),width=9,height=9,units = "in",res=300)
print(gtsne_genes)
dev.off()
#png(file=paste0(output_dir,"/",as.character(group_name),"umap_genes.png"),width=9,height=9,units = "in",res=300)
#print(gmap_genes)
#dev.off()
}
}
# file info
file_info <- readRDS("data/graph_info_df/file_info_nodups.rds")
file_info <- file_info %>% dplyr::select(files_combined,sig_id,rdkit,cell_id,count.x,emb)
# embs
emb <- read.csv("embeddings/graph2vec/emb_activity_1_epoch.csv")
# embs
emb <- read.csv("embeddings/ged_distance/ged_embs512_seen_4ep.csv")
emb <- emb[,-1]
colnames(emb)[1] <- "emb"
emb <- emb[which(as.character(emb$emb) %in% as.character(file_info$emb)),]
file_info <- file_info[which(as.character(file_info$emb) %in% as.character(emb$emb)),]
file_info <- file_info %>% group_by(sig_id) %>% sample_n(1) %>% ungroup()
emb <- emb[which(as.character(emb$emb) %in% as.character(file_info$emb)),]
View(targets)
htr <- targets$target[grepl(pattern = "HTR",x = targets$target)]
group_name <- "htr"
output_dir <- paste0("group_check/",as.character(group_name))
obg = "HTR2A"
ds_path <- "C:/Users/user/Documents/phd/GSE92742_Broad_LINCS_Level5_COMPZ.MODZ_n473647x12328.gctx"
landmark <- read_tsv(file = "data/cmap/util_files/cmap_landmark_genes.txt")
sig_map <- readRDS("data/graph_info_df/sig_mapping.rds")
all_orig <- readRDS("data/cmap/labels.rds")
View(all_orig)
View(moa_v1)
